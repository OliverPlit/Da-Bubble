<!-- Desktop: Mat-Drawer -->
<mat-drawer-container *ngIf="!isMobile" class="container-height" hasBackdrop="false" [class.menu-open]="isMenuOpen">
  <mat-drawer #drawer class="sidenav" mode="side" [(opened)]="isMenuOpen">
    <div class="header-menu">
      <div>
        <img src="/img/logo-menu-devspace.png" alt="">
        <h2>Devspace</h2>
      </div>
      <img src="/img/edit-square.png" alt="" class="write-message" (click)="onOpenNewMessage()">
    </div>

    <div class="header-menu-channels">
      <div (click)="toggleChannels()">
        <img src="/img/arrow-drop-menu.png" alt="" class="arrow-icon" [class.arrow-collapsed]="!showChannels">
        <img src="/img/channel.png" alt="">
        <h3>Channels</h3>
      </div>
      <img src="/img/add-channel.png" alt="" class="write-message" matButton (click)="openDialog()">
    </div>
    
    <div class="channel-list" *ngIf="showChannels">
      <app-channels></app-channels>
    </div>

    <div class="header-menu-channels" (click)="toggleMessages()">
      <div>
        <img src="/img/arrow-drop-menu.png" alt="" class="arrow-icon" [class.arrow-collapsed]="!showMessages">
        <img src="/img/direct-person.png" alt="">
        <h3>Direktnachrichten</h3>
      </div>
    </div>
    
    <div class="channel-list" *ngIf="showMessages">
      <app-direct-messages></app-direct-messages>
    </div>
  </mat-drawer>
</mat-drawer-container>

<!-- Mobile: Einfacher Container ohne Mat-Drawer -->
<div *ngIf="isMobile" class="mobile-menu-container">
  <div class="mobile-search-wrap">
    <input 
      class="search"
      type="text" 
      placeholder="Gehe zu... (# Channels, @ Personen)"
      [(ngModel)]="searchQuery"
      (input)="onSearchInput()"
      (focus)="showSearchResults = searchQuery.length > 0"
    >
    <div class="search-results" *ngIf="showSearchResults">
      <div class="search-loading" *ngIf="isSearching">
        <p>Suche läuft...</p>
      </div>
      <div class="no-results" *ngIf="!isSearching && searchResults.length === 0">
        <p>Keine Ergebnisse gefunden</p>
        <small># für Channels oder @ für Personen</small>
      </div>
      <div class="results-list" *ngIf="!isSearching && searchResults.length > 0">
        <div class="search-result-item" *ngFor="let result of searchResults" (click)="selectSearchResult(result)">
          <div class="result-content" *ngIf="result.type === 'channel'">
            <div class="result-icon channel-icon">#</div>
            <div class="result-details">
              <p class="result-title">{{ result.title }}</p>
              <small class="result-subtitle">{{ result.subtitle }}</small>
              <small class="result-meta" *ngIf="result.content">{{ result.content }}</small>
            </div>
          </div>
          <div class="result-content" *ngIf="result.type === 'direct'">
            <img class="result-avatar" [src]="'/img/avatars/' + (result.avatar || 'avatar-0.png')" alt="">
            <div class="result-details">
              <p class="result-title">{{ result.title }}</p>
              <small class="result-subtitle">{{ result.subtitle }}</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="header-menu">
    <div>
      <img src="/img/logo-menu-devspace.png" alt="">
      <h2>Devspace</h2>
    </div>
    <img src="/img/edit-square.png" alt="" class="write-message" (click)="onOpenNewMessage()">
  </div>

  <div class="header-menu-channels">
    <div (click)="toggleChannels()">
      <img src="/img/arrow-drop-menu.png" alt="" class="arrow-icon" [class.arrow-collapsed]="!showChannels">
      <img src="/img/channel.png" alt="">
      <h3>Channels</h3>
    </div>
    <img src="/img/add-channel.png" alt="" class="write-message" matButton (click)="openDialog()">
  </div>
  
  <div class="channel-list" *ngIf="showChannels">
    <app-channels></app-channels>
  </div>

  <div class="header-menu-channels" (click)="toggleMessages()">
    <div>
      <img src="/img/arrow-drop-menu.png" alt="" class="arrow-icon" [class.arrow-collapsed]="!showMessages">
      <img src="/img/direct-person.png" alt="">
      <h3>Direktnachrichten</h3>
    </div>
  </div>
  
  <div class="channel-list" *ngIf="showMessages">
    <app-direct-messages></app-direct-messages>
  </div>
</div>

<img src="/img/mobile-new-message.png" alt="" *ngIf="isMobile" class="mobile-message" (click)="onOpenNewMessage()">